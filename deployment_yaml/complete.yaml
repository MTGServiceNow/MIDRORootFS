kind: Namespace
apiVersion: v1
metadata:
  name: servicenow
  labels:
    name: servicenow
---
apiVersion: apps/v1 
kind: Deployment 
metadata: 
  name: mid-deployment
  namespace: servicenow 
  annotations: 
    testannotation: "thisismytest"
spec: 
  selector: 
    matchLabels: 
      app: mid 
  replicas: 1 
  template: 
    metadata: 
      labels: 
        app: mid 
      name: mid 
    securityContext:
      runAsUser: 101
      runAsGroup: 101
      fsGroup: 101
      supplementalGroups:
        - 150
    spec: 
      containers:
        - name: mid-service 
          imagePullPolicy: Always 
          image: k8smid.azurecr.io/k8smid:latest
          resources:
            requests:
              cpu: 50m
              memory: 300M
          env: 
            - name: MID_INSTANCE_URL 
              value: "https://mtg3demo.service-now.com"
            - name: MID_INSTANCE_USERNAME 
              value: "k8smid_user" 
            - name: MID_INSTANCE_PASSWORD 
              valueFrom:
               secretKeyRef:
                  name: mid-server-secret
                  key: SN_PASSWD
            - name: MID_SECRETS_FILE 
              value: "" 
            - name: MID_SERVER_NAME 
              value: "SanDiegoMIDContainer"
            - name: MID_PROXY_HOST 
              value: "" 
            - name: MID_PROXY_PORT 
              value: "" 
            - name: MID_PROXY_USERNAME 
              value: "" 
            - name: MID_PROXY_PASSWORD 
              value: "" 
            - name: MID_MUTUAL_AUTH_PEM_FILE 
              value: "" 
            - name: MID_WORKING_DIR
              value: "/emptyDir/snc_mid_server"
      volumeMounts:
      - mountPath: "/emptyDir/snc_mid_server"
        name: working-dir
      securityContext:
        runAsUser: 101
        runAsGroup: 101
        allowPrivilegeEscalation: false
        privileged: false
        procMount: default
        readOnlyRootFilesystem: true
        seccompProfile:
          type: RuntimeDefault
    volumes:
    - name: working-dir
      emptyDir: {}